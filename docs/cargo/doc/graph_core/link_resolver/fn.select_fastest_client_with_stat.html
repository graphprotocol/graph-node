<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="The IPFS APIs don’t have a quick “do you have the file” function. Instead, we just rely on whether an API times out. That makes sense for IPFS, but not for our application. We want to be able to quickly select from a potential list of clients where hopefully one already has the file, and just get the file from that."><meta name="keywords" content="rust, rustlang, rust-lang, select_fastest_client_with_stat"><title>graph_core::link_resolver::select_fastest_client_with_stat - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings"></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../graph_core/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class="location"><a href="../index.html">graph_core</a>::<wbr><a href="index.html">link_resolver</a></p><div id="sidebar-vars" data-name="select_fastest_client_with_stat" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" class="help-button">?</button>
                <a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Function <a href="../index.html">graph_core</a>::<wbr><a href="index.html">link_resolver</a>::<wbr><a class="fn" href="">select_fastest_client_with_stat</a></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/graph_core/link_resolver.rs.html#88-130" title="goto source code">[src]</a></span></h1><pre class="rust fn">async fn select_fastest_client_with_stat(<br>&nbsp;&nbsp;&nbsp;&nbsp;clients: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;<a class="struct" href="../../graph/ipfs_client/struct.IpfsClient.html" title="struct graph::ipfs_client::IpfsClient">IpfsClient</a>&gt;&gt;&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;logger: Logger, <br>&nbsp;&nbsp;&nbsp;&nbsp;path: <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/string/struct.String.html" title="struct alloc::string::String">String</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;timeout: <a class="struct" href="https://doc.rust-lang.org/nightly/core/time/struct.Duration.html" title="struct core::time::Duration">Duration</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;do_retry: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a><br>) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">(</a><a class="struct" href="../../graph/ipfs_client/struct.ObjectStatResponse.html" title="struct graph::ipfs_client::ObjectStatResponse">ObjectStatResponse</a>, <a class="struct" href="https://doc.rust-lang.org/nightly/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;<a class="struct" href="../../graph/ipfs_client/struct.IpfsClient.html" title="struct graph::ipfs_client::IpfsClient">IpfsClient</a>&gt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.tuple.html">)</a>, <a class="struct" href="https://docs.rs/anyhow/1.0.41/anyhow/struct.Error.html" title="struct anyhow::Error">Error</a>&gt;</pre><div class="docblock"><p>The IPFS APIs don’t have a quick “do you have the file” function. Instead, we
just rely on whether an API times out. That makes sense for IPFS, but not for
our application. We want to be able to quickly select from a potential list
of clients where hopefully one already has the file, and just get the file
from that.</p>
<p>The strategy here then is to use the object_stat API as a proxy for “do you
have the file”. Whichever client has or gets the file first wins. This API is
a good choice, because it doesn’t involve us actually starting to download
the file from each client, which would be wasteful of bandwidth and memory in
the case multiple clients respond in a timely manner. In addition, we may
make good use of the stat returned.</p>
</div></section><section id="search" class="content hidden"></section><section class="footer"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="graph_core" data-search-js="../../search-index.js"></div>
    <script src="../../main.js"></script></body></html>